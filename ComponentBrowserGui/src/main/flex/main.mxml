<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"
				xmlns:common="clarin.cmdi.componentregistry.common.components.*"
				layout="absolute"
				preinitialize="initializeInstances();"
				applicationComplete="init();"
				backgroundColor="#DDE3EF">
	<mx:Style source="/assets/css/main.css"/>
	<mx:Script>
		<![CDATA[
		    import clarin.cmdi.componentregistry.services.PingSessionService;
			import mx.controls.Alert;
			import clarin.cmdi.componentregistry.common.StyleConstants;
			import clarin.cmdi.componentregistry.services.Config;
			import clarin.cmdi.componentregistry.common.Credentials;
			import flash.net.navigateToURL;
			import mx.managers.PopUpManager;
			import org.hasseg.externalMouseWheel.ExternalMouseWheelSupport;

			private var sessionPinger:PingSessionService = PingSessionService.INSTANCE;


			private function initializeInstances():void {
				Config.create(Application.application.parameters);
				Credentials.create(Application.application.parameters);
			}

			private function init():void {
				ExternalMouseWheelSupport.getInstance(stage);
				sessionPinger.startPinging();
			}
			
//			private function handleLogin(event:MouseEvent):void {
//				var req:URLRequest = new URLRequest();
//				req.url = Config.instance.serviceRootUrl + "?shhaaDo=lI";
//				navigateToURL(req, "_top");
//			}
		]]>
	</mx:Script>

	<mx:Panel width="100%"
			  height="100%"
			  layout="absolute"
			  title="Clarin Component Browser"
			  x="0"
			  y="0">

		<mx:VBox height="100%"
				 width="100%">
			<mx:HBox borderStyle="none"
					 width="100%">
				<mx:ToggleButtonBar id="toggleBar"
									dataProvider="{viewStack}"/>
				<mx:Spacer width="90%"/>
				<mx:Label text="User: {Credentials.instance.userName}"/>
				<!--				<mx:Button id="login"
					 label="login {userName}"
					 click="handleLogin(event)"/>-->
			</mx:HBox>
			<common:RegistryViewStack id="viewStack"
									  borderStyle="none"
									  height="100%"
									  width="100%"/>
		</mx:VBox>
	</mx:Panel>
</mx:Application>
